/*!
 * particle-bg v0.5.0
 * https://github.com/PengJiyuan/particle-bg
 *
 * Copyright (c) 2018 PengJiyuan
 * Licensed under the MIT license.
 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.particleBg=i()}(this,function(){"use strict";function n(t,i){var e=window.devicePixelRatio||1,h=null;return t.forEach(function(t){h=t.getContext("2d"),t.style.position=i.position,t.style.width=i.width+"px",t.style.height=i.height+"px",t.width=i.width*e,t.height=i.height*e,h.scale(e,e)}),t}function e(t,i){var e=this;void 0===i&&(i={}),this.element=document.querySelector(t),this.color=i.color||"#fff",this.width=this.element.clientWidth,this.height=this.element.clientHeight,this.distance=i.distance||this.width/10,this.radius=i.radius||2,this.points=[],this.count=i.count||100,this.zIndex=i.zIndex||1,this.rate=i.rate||this.width/1e4,this.resize="boolean"!=typeof i.resize||i.resize,this.line="boolean"!=typeof i.line||i.line,this.bounce="boolean"==typeof i.bounce&&i.bounce,this.appendCanvas();for(var h=0;h<this.count;h++)this.points.push(this.getPoint());this.resize&&(window.onresize=function(){e.width=e.element.clientWidth,e.height=e.element.clientHeight,e.distance=i.distance||e.width/10,e.rate=i.rate||e.width/1e4,e.canvas.width=e.width,e.canvas.height=e.height,n([e.canvas],{width:e.width,height:e.height})})}return e.prototype.getPoint=function(){return{x:Math.ceil(Math.random()*this.width),y:Math.ceil(Math.random()*this.height),r:+(Math.random()*this.radius).toFixed(4),rateX:+(2*Math.random()-1).toFixed(4),rateY:+(2*Math.random()-1).toFixed(4)}},e.prototype.appendCanvas=function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height,n([this.canvas],{width:this.width,height:this.height}),this.canvas.style.zIndex=this.zIndex,this.element.appendChild(this.canvas)},e.prototype.draw=function(){this.ctx.clearRect(0,0,this.width,this.height),this.drawPoints(),this.line&&this.drawLines(),window.requestAnimationFrame(this.draw.bind(this))},e.prototype.drawPoints=function(){var e=this;this.points.forEach(function(t,i){e.ctx.beginPath(),e.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!1),e.ctx.fillStyle=e.color,e.ctx.fill(),e.bounce?(t.x>=t.r&&t.x<=e.width-t.r&&t.y>=t.r&&t.y<=e.height-t.r||((t.x<t.r||t.x>e.width-t.r)&&(t.rateX=-t.rateX),(t.y<t.r||t.y>e.height-t.r)&&(t.rateY=-t.rateY)),t.x+=t.rateX*e.rate,t.y+=t.rateY*e.rate):t.x>=0-t.r&&t.x<=e.width+t.r&&t.y>=0-t.r&&t.y<=e.height+t.r?(t.x+=t.rateX*e.rate,t.y+=t.rateY*e.rate):(e.points.splice(i,1),e.points.push(e.getPoint(e.radius)))})},e.prototype.dis=function(t,i,e,h){e=Math.abs(t-e),h=Math.abs(i-h);return Math.sqrt(e*e+h*h)},e.prototype.drawLines=function(){for(var t=this.points.length,i=0;i<t;i++)for(var e=t-1;0<=e;e--){var h=this.points[i].x,n=this.points[i].y,s=this.points[e].x,o=this.points[e].y,a=this.dis(h,n,s,o);a<=this.distance&&(this.ctx.beginPath(),this.ctx.moveTo(h,n),this.ctx.lineTo(s,o),this.ctx.strokeStyle=this.color,this.ctx.lineWidth=1-a/this.distance,this.ctx.stroke())}},function(t,i){new e(t,i).draw()}});
